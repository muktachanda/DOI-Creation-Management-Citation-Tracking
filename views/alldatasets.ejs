<!DOCTYPE html>
<html>

<head>
    <title>All Datasets</title>
    <link rel="stylesheet" type="text/css" href="path/to/your/styles.css">
    <style>
        /* Additional CSS styles for the card view */
        .card {
            max-width: 400px;
            margin: 10px;
            padding: 20px;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            cursor: pointer;
        }

        .card-title {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .info-popup {
            display: none;
            position: absolute;
            background-color: #fff;
            border: 1px solid #ccc;
            padding: 10px;
            z-index: 1;
        }

        .slider-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #f1f1f1;
            padding: 10px;
            overflow-x: hidden;
            white-space: nowrap;
            display: flex;
            justify-content: space-between;
        }

        .citation-slider {
            overflow-x: auto;
            white-space: nowrap;
            width: 100%;
        }

        .citation-card {
            display: inline-block;
            padding: 10px;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-right: 10px;
        }

        .copy-icon {
            display: inline-block;
            margin-left: 5px;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <% datasets.forEach((dataset)=> { %>
        <div class="card">
            <h2 class="card-title">
                <%= dataset.name %>
            </h2>
            <p>Author: <%= dataset.author %>
            </p>
            <p>Publication Year: <%= dataset.publicationYear %>
                    <p>
                        <span style="text-decoration: none; color: inherit;">File Link: </span>
                        <span style="text-decoration: underline; color: blue;"
                            onclick="openCSVFile('<%= dataset.fileLink %>')">
                            <%= dataset.fileLink %>
                        </span>
                    </p>
                    <p>
                        <span style="text-decoration: none; color: inherit;">License: </span>
                        <span style="text-decoration: underline; color: blue;"
                            onclick="openLicenseURL('<%= dataset.license.info %>')">
                            <%= dataset.license.name %>
                        </span>
                    </p>

            </p>
            <p>
                Generate Citations:
                <button
                    onclick="generateCitations('<%= dataset.name %>','<%= dataset.author %>', '<%= dataset.publicationYear %>', 'vancouver', '<%= dataset.fileLink %>')">Vancouver</button>
                <button
                    onclick="generateCitations('<%= dataset.name %>', '<%= dataset.author %>', '<%= dataset.publicationYear %>', 'bibtex', '<%= dataset.fileLink %>')">BibTeX</button>
                <button
                    onclick="generateCitations('<%= dataset.name %>', '<%= dataset.author %>', '<%= dataset.publicationYear %>', 'american', '<%= dataset.fileLink %>')">American</button>
            </p>
        </div>
        <% }); %>

            <div class="slider-container">
                <div class="citation-slider" id="citation-slider"></div>
            </div>

            <script>
                let currentDataset = '';

                function generateCitations(datasetName, author, year, format, datasetURL) {
                    const citations = {
                        'vancouver': `${author}. ${datasetName}. ${year}. URL: ${datasetURL}`,
                        'bibtex': `@misc{${datasetName},
                title = {${datasetName}},
                howpublished = {\\url{${datasetURL}}},
                year = {${year}}
            }`,
                        'american': `${author}. ${year}. ${datasetName}. URL: ${datasetURL}`,
                    };

                    const formattedCitation = citations[format];

                    if (formattedCitation) {
                        const citationSlider = document.getElementById("citation-slider");
                        citationSlider.innerHTML = '';

                        const citationCard = document.createElement("div");
                        citationCard.className = "citation-card";

                        const citationText = document.createElement("span");
                        citationText.textContent = formattedCitation;
                        citationCard.appendChild(citationText);

                        const copyIcon = document.createElement("span");
                        copyIcon.className = "copy-icon";
                        copyIcon.textContent = "ðŸ“‹"; // Unicode for clipboard icon
                        copyIcon.addEventListener("click", () => copyToClipboard(formattedCitation));
                        citationCard.appendChild(copyIcon);

                        citationSlider.appendChild(citationCard);
                    } else {
                        alert('Unsupported citation format.');
                    }
                }

                function copyToClipboard(text) {
                    const tempInput = document.createElement("textarea");
                    tempInput.value = text;
                    document.body.appendChild(tempInput);
                    tempInput.select();
                    document.execCommand("copy");
                    document.body.removeChild(tempInput);
                    alert("Citation copied to clipboard!");
                }

                function openLicenseURL(url) {
                    window.open(url, '_blank');
                }

                function openCSVFile(filename) {
                    const fileURL = `/openDataset/${filename}`;
                    console.log('File URL', fileURL);
                    window.open(fileURL, '_blank');
                }

            </script>
</body>

</html>